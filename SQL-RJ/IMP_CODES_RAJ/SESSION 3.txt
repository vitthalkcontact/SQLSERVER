use test;

select * from emp;
select * from emp_sal;


SELECT EMP.EID, EMP.NAME, EMP.DOJ, EMP_SAL.DEPT, EMP_SAL.DESI, EMP_SAL.SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;

SELECT * FROM CJ1;
SELECT * FROM CJ2;

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
CROSS JOIN CJ2
WHERE CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
INNER JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

-- CROSS JOIN + WHERE = INNER JOIN 

SELECT * FROM SJ;

SELECT * FROM BOSS;

SELECT SJ.ID, SJ.NAME AS 'EMP NAME', BOSS.NAME as 'BOSS NAME'
FROM SJ
LEFT JOIN BOSS
ON SJ.bossID = BOSS.BID;

SELECT * FROM SJ;
SELECT * FROM SJ;

SELECT S1.ID, S1.NAME AS 'EMP NAME', S2.NAME as 'BOSS NAME'
FROM SJ S1
LEFT  JOIN SJ S2
ON S1.bossID = S2.ID;



CREATE TABLE A1
(VAL CHAR(1));

CREATE TABLE A2
(VAL INT);

INSERT INTO A1 VALUES ('A');
INSERT INTO A1 VALUES ('B');
INSERT INTO A1 VALUES ('C');
INSERT INTO A1 VALUES ('D');

INSERT INTO A2 VALUES (1);
INSERT INTO A2 VALUES (2);
INSERT INTO A2 VALUES (3);


SELECT * FROM A1;
SELECT * FROM A2;

SELECT A1.VAL, A2.VAL FROM A1
CROSS JOIN A2;




SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

UNION

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

UNION ALL

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;



SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

INTERSECT

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

EXCEPT

SELECT CJ1.RNO,CJ1.NAME, CJ2.MARKS FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT * FROM CJ1;
SELECT * FROM CJ2;

SELECT EID, NAME, CITY, DOB  FROM EMP WHERE CITY ='CHANDIGARH'
UNION
SELECT EID, NAME, CITY, DOB  FROM EMP WHERE CITY ='DEHRADUN';


SELECT * FROM EMP WHERE CITY = 'DELHI';

SELECT * FROM EMP WHERE ADDRESS2 = 'DWARKA';

CREATE INDEX IND_CT1 ON EMP (CITY);
2
DROP INDEX IND_CT1 ON EMP;

CREATE INDEX IND_CT1 ON EMP (CITY, ADDRESS2);

-- IMPLICIT - CREATED AUTOMATICALLY (PK , UNIQUE)     EXPLICIT - WE CREATE


-- CLUSTERED INDEX 

-- NON CLUSTERED INDEX

CREATE CLUSTERED INDEX IND_CT1 ON EMP (CITY);

USE leARn;


CREATE TABLE TEST
(ID INT,
NAME CHAR(5),
CITY VARCHAR(10));

INSERT INTO TEST VALUES (1,'A','DEL');
INSERT INTO TEST VALUES (2,'B','GGN');
INSERT INTO TEST VALUES (3,'C','FBD');
INSERT INTO TEST VALUES (4,'D','DEL');
INSERT INTO TEST VALUES (5,'E','NOIDA');
INSERT INTO TEST VALUES (6,'A','GGN');


SELECT * FROM TEST;

ALTER TABLE TEST
ALTER COLUMN ID CHAR(5) NOT NULL;

ALTER TABLE TEST
ADD CONSTRAINT PKID PRIMARY KEY (ID);
ALTER TABLE TEST
DROP CONSTRAINT PKID;

CREATE CLUSTERED INDEX INDCTY ON TEST (CITY);

DROP INDEX INDCTY ON TEST;
DROP INDEX PKID ON TEST;

USE TEST;

CREATE VIEW DDNEMP 
AS
	( SELECT * FROM EMP WHERE CITY ='DEHRADUN');

SELECT * FROM DDNEMP;

CREATE VIEW V_EMP
AS
	(SELECT EID, NAME,CITY, PHONENO,EMAIL FROM EMP);

SELECT * FROM V_EMP;


CREATE VIEW V_PS 
AS
	(SELECT EMP.EID, NAME, DOJ, DEPT, DESI, SALARY AS 'BASIC' , SALARY *.9 AS 'PF' , SALARY *.15 AS 'HRA'
	FROM EMP
	INNER JOIN EMP_SAL
	ON EMP.EID=EMP_SAL.EID);

SELECT * FROM V_PS;