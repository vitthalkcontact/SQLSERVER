USE LEARN;

CREATE TABLE EMP
(EID CHAR(5),
NAME VARCHAR(10) NOT NULL,
ADDR VARCHAR(30),
CITY VARCHAR(10) DEFAULT 'DELHI',
DOB DATE  CHECK (DOB >='01-JAN-1998'),
PHNO CHAR(15) UNIQUE,
PRIMARY KEY (EID) );

INSERT INTO EMP (EID, ADDR, CITY, DOB, PHNO)
VALUES ('E0001', 'DWARKA SEC 11' , 'DELHI', '10-JAN-1999', '9899767650');

INSERT INTO EMP (EID,NAME, ADDR, CITY, DOB, PHNO)
VALUES ('E0002', 'MOHIT' ,'DWARKA SEC 12' , 'DELHI', '10-NOV-1999', '9899761111');

INSERT INTO EMP (EID,NAME, ADDR, DOB, PHNO)
VALUES ('E0003', 'KAPIL' ,'C2/10 JANAKPURI' , '14-FEB-1998', '9899000011');

INSERT INTO EMP 
VALUES ('E0004', 'ROHIT' ,'DLF PHASE 1' , 'GURGAON', '25-FEB-2000', '9099000099');

INSERT INTO EMP 
VALUES ('E0005', 'MONIKA' ,'456 SECTOR 60' , 'NOIDA', '03-MAR-2000', '9099011099');

INSERT INTO EMP 
VALUES ('E0006', 'AMRESH' ,'42/5 RAMESH NAGAR' , 'DELHI', '03-MAR-1999', '9099011080');

INSERT INTO EMP 
VALUES ('E0007', 'KUSH' ,'267 UDYOG VIHAR - 1' , 'GURGAON', '03-MAR-1999', '9999011009');


UPDATE EMP SET NAME ='RAMESH' ;

SELECT * FROM EMP;

ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(10) NOT NULL;

ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(10) ;


ALTER TABLE EMP
ADD CONSTRAINT R1 DEFAULT 'DELHI' FOR CITY;

ALTER TABLE EMP
DROP CONSTRAINT R1;

ALTER TABLE EMP
ADD CONSTRAINT R2 UNIQUE (PHNO);

ALTER TABLE EMP 
ADD CONSTRAINT R3_DOB  CHECK (DOB >='01-JAN-1998');

ALTER TABLE EMP
ALTER COLUMN EID CHAR(5) NOT  NULL;

ALTER TABLE EMP
ADD CONSTRAINT PK_EID PRIMARY KEY (EID);


CREATE TABLE EMP_SAL
(EID CHAR(5) REFERENCES EMP (EID),
DEPT VARCHAR(10),
DESI VARCHAR(20),
SALARY INT);

DROP TABLE EMP_SAL;
	
INSERT INTO EMP_SAL
VALUES('E0010', 'HR', 'MANAGER', 70000);

DELETE EMP_SAL;

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;

ALTER TABLE EMP_SAL
ADD CONSTRAINT FK_EID FOREIGN KEY (EID) REFERENCES EMP (EID);


-- BETWEEN  - RANGE

-- IN  - LIST

-- LIKE - PATERN MATCHING

USE TEST;

SELECT COUNT (NAME ) FROM EMP;

SELECT * FROM EMP;

-- DISTINCT - UNIQUE VALUES OF A FILED

-- ORDER BY - SORTING

SELECT * FROM EMP_SAL
ORDER BY SALARY DESC;

SELECT * FROM EMP_SAL
ORDER BY DEPT, SALARY ;


SELECT DEPT, COUNT (EID) AS 'TEAM SIZE' ,SUM (SALARY) AS 'TOTALCOST' FROM EMP_SAL
GROUP BY DEPT
ORDER BY SUM(SALARY) DESC;

SELECT DEPT, COUNT (EID) AS 'TEAM SIZE' ,SUM (SALARY) AS 'TOTALCOST' FROM EMP_SAL
GROUP BY DEPT
HAVING SUM(SALARY)>500000;

SELECT * FROM EMP_SAL
WHERE DESI LIKE '%MANAGER%';

SELECT DEPT , SUM(SALARY)  AS 'MANAGER COST' FROM EMP_SAL
WHERE DESI LIKE '%MANAGER%'
GROUP BY DEPT
HAVING SUM(SALARY) >100000
ORDER BY SUM(SALARY) DESC;


--JOINS--

-- INNRER JOIN  - RETURNS THE COMMON RECORDS

SELECT * FROM EMP ;
SELECT * FROM EMP_SAL ;

SELECT EMP.EID, EMP.NAME, EMP.CITY,  EMP.DOB, EMP.DOJ, EMP_SAL.DEPT, EMP_SAL.DESI, EMP_SAL.SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;

SELECT E1.EID, E1.NAME, E1.CITY, E1.DOB, E1.DOJ , E2.DEPT, E2.DESI, E2.SALARY 
FROM EMP E1
INNER JOIN EMP_SAL E2
ON E1.EID= E2.EID;


SELECT EMP.EID, NAME , CITY, DOB, DEPT, DESI, SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;

SELECT * FROM TRAINING;

ALTER TABLE TRAINING 
ADD MODULE VARCHAR(10);

UPDATE TRAINING SET MODULE = 'SQL';

SELECT EMP.EID, EMP.NAME, EMP.CITY, EMP.DOJ , EMP_SAL.DEPT, EMP_SAL.SALARY, TRAINING.MODULE
FROM EMP 
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID
INNER JOIN TRAINING
ON EMP.EID= TRAINING.EID;


SELECT EMP.EID, NAME , CITY, DOB, DEPT, DESI, SALARY
FROM EMP
LEFT JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;


SELECT * FROM CJ1;
SELECT * FROM CJ2;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
FULL JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


